{% extends 'base.html' %}
{% load i18n %}
{% block title %}{% trans 'Login' %}{% endblock %}
{% load crispy_forms_tags %}
{% block body %}
{% if request.user.is_authenticated %}
    <h4 class="text-center">{% trans 'Login Page' %}</h4>
    <p class="lead">{% trans 'You need to logout to access this page.' %}</p><br>
    <p class="lead"> {% trans 'To logout click' %} <a href="{% url 'accounts:logout_page' %}">{% trans 'here'%}</a>.</p>
{% else %}
<div class="card" >
   <div class="card-body">
     <h4 class="card-title text-center">{% trans 'Login' %}</h4><br />
     <div class="row">
         <div class = "col-md-6">
             <label class="iclass">{% trans 'Question 1' %}</label><br>
               <audio controls>
                 <source src="{{ link1 }}" type="audio/mpeg">
                 {% trans 'Your browser does not support the audio element.' %}
             </audio><br/><br>
        </div>
        <div class = "col-md-6">
            <label class="iclass">{% trans 'Question 2' %}</label><br>
              <audio controls>
                <source src="{{ link2 }}" type="audio/mpeg">
                {% trans 'Your browser does not support the audio element.' %}
            </audio><br/><br>
        </div>
    </div>
    <div class="row">
        <div class = "col-md-6">
            <label class="iclass">{% trans 'Question 3' %}</label><br>
              <audio controls>
                <source src="{{ link3 }}" type="audio/mpeg">
                {% trans 'Your browser does not support the audio element.' %}
            </audio><br/><br>
       </div>
       <div class = "col-md-6">
           <label class="iclass">{% trans 'Question 4' %}</label><br>
             <audio controls>
               <source src="{{ link4 }}" type="audio/mpeg">
               {% trans 'Your browser does not support the audio element.' %}
           </audio><br/><br>
       </div>
    </div>
     <form  method="post" enctype="multipart/form-data">
       {% csrf_token %}
       <!-- {{ form|crispy }} -->
       {% if form.errors %}
            {% for error in form.non_field_errors %}
                <div class="alert alert-danger">
                    <strong>{{ error|escape }}</strong>
                </div>
                {%endfor%}
        {% endif %}
        <input type = "hidden" name="{{ form.gq1.html_name }}" value="{{ gq1 }}"/>
        <input type = "hidden" name="{{ form.gq2.html_name }}" value="{{ gq2 }}"/>
       <div class="form-group iclass">
           <label class="iclass" for="un">{{ form.username.label_tag }}</label>
           <input class="form-control" id="un" maxlength="30" name="{{ form.username.html_name }}" placeholder="" type="text" value="{{user.username}}" readonly/>
       </div>
       <div class="form-group iclass">
           <label class="iclass" for="pw">{{ form.answer1.label_tag }}</label>
           <input class="form-control" id="ans1" maxlength="30" name="{{ form.answer1.html_name }}" placeholder=" " type="text" readonly/><br>
           <button class="btn submit-btn" type="button"  id="start-btn1"  name="button">{% trans 'Record' %}</button>
           <!-- <p id="instructions">Press the Start button</p> -->
           {% if form.answer1.errors%}

           <div class="alert alert-danger">
               <strong>{{ form.answer1.errors|escape }}</strong>
           </div>
           {% endif %}
       </div>
       <div class="form-group iclass">
           <label class="iclass" for="pw">{{ form.answer2.label_tag }}</label>
           <input class="form-control" id="ans2" maxlength="30" name="{{ form.answer2.html_name }}" placeholder=" " type="text" readonly/><br>
           <button class="btn submit-btn" type="button"  id="start-btn2"  name="button">{% trans 'Record' %}</button>
           <!-- <p id="instructions">Press the Start button</p> -->
           {% if form.answer2.errors%}
           <div class="alert alert-danger">
               <strong>{{ form.answer2.errors|escape }}</strong>
           </div>
           {% endif %}
       </div>
       <div class="form-group iclass">
           <label class="iclass" for="pw">{{ form.answer3.label_tag }}</label>
           <input class="form-control" id="ans3" maxlength="30" name="{{ form.answer3.html_name }}" placeholder=" " type="text" readonly/><br>
           <button class="btn submit-btn" type="button"  id="start-btn3"  name="button">{% trans 'Record' %}</button>
           <!-- <p id="instructions">Press the Start button</p> -->
           {% if form.answer3.errors%}

           <div class="alert alert-danger">
               <strong>{{ form.answer3.errors|escape }}</strong>
           </div>
           {% endif %}
       </div>
       <div class="form-group iclass">
           <label class="iclass" for="pw">{{ form.answer4.label_tag }}</label>
           <input class="form-control" id="ans4" maxlength="30" name="{{ form.answer4.html_name }}" placeholder=" " type="text" readonly/><br>
           <button class="btn submit-btn" type="button"  id="start-btn4"  name="button">{% trans 'Record' %}</button>
           <!-- <p id="instructions">Press the Start button</p> -->
           {% if form.answer4.errors%}

           <div class="alert alert-danger">
               <strong>{{ form.answer4.errors|escape }}</strong>
           </div>
           {% endif %}
       </div>
       <div class="form-group iclass">
           <label class="iclass" for="pw">{{ form.password.label_tag }}</label>
           <input class="form-control" id="pw" maxlength="30" name="{{ form.password.html_name }}" placeholder=" " type="password" />
       </div>
       <div class="form-group text-center">
           <button type="submit" class="btn submit-btn">{% trans 'Login' %}</button>
       </div>

     </form>
   </div>
 </div>
{%endif%}
{%endblock%}
{% block javascript %}
    <script>
        $(document).ready(function() {
            $("#start-btn1").click(function () {
                $("#ans1").val('success');
                $.ajax({
                    url: '/ajax/stt_ans/',
                    data: {
                      'username' : $('#un').val() ,
                      'no_': '1'
                    },
                    dataType: 'json',
                    success: function (data) {
                      if (data.success) {
                        alert(data.text);
                      }else{
                         alert("Could not recognise");
                      }
                    }
                });
            });
        });
    </script>
{% endblock %}
